<!--SANS LOCALISATION-->

<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <title>D√©tails du suspect</title>-->
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--    <style>-->
<!--        /* Style conserv√© + animation */-->
<!--        body { background-color: #f8f9fa; }-->
<!--        .sidebar { height: 100vh; background-color: #343a40; color: white; padding-top: 20px; }-->
<!--        .sidebar a { color: #adb5bd; display: block; padding: 10px 20px; text-decoration: none; }-->
<!--        .sidebar a:hover { background-color: #495057; color: white; }-->
<!--        .profile-img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }-->
<!--        .suspect-details { display: flex; align-items: flex-start; gap: 20px; flex-wrap: wrap; }-->
<!--        .suspect-img { width: 300px; border-radius: 8px; box-shadow: 0 2px 6px rgba(23, 74, 211, 0.15); }-->
<!--        .info-block { flex: 1; }-->
<!--        .status-info { font-weight: bold; font-size: 1.1em; color: #6d884c; }-->
<!--        .back-link { display: inline-block; margin-top: 20px; color: #007bff; text-decoration: none; font-weight: 600; }-->
<!--        .back-link:hover { text-decoration: underline; }-->
<!--        button { background-color: #007bff; border: none; color: white; padding: 10px 16px; border-radius: 4px; cursor: pointer; font-size: 1em; margin-top: 15px; }-->
<!--        button:hover { background-color: #0056b3; }-->
<!--        #loadingSpinner { display: none; margin-top: 15px; color: #007bff; }-->
<!--        @media (max-width: 768px) {-->
<!--            .suspect-details { flex-direction: column; align-items: center; }-->
<!--            .suspect-img { width: 100%; max-width: 320px; }-->
<!--            .info-block { width: 100%; }-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--&lt;!&ndash; NAVBAR &ndash;&gt;-->
<!--<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">-->
<!--    <a class="navbar-brand" href="#">üöì Syst√®me De Reconnaissance Faciale</a>-->
<!--    <div class="ms-auto d-flex align-items-center gap-3">-->
<!--        <a href="/logout" class="btn btn-outline-light btn-sm">Compte</a>-->
<!--    </div>-->
<!--</nav>-->

<!--&lt;!&ndash; CONTENU PRINCIPAL &ndash;&gt;-->
<!--<div class="container-fluid">-->
<!--    <div class="row">-->
<!--        &lt;!&ndash; Sidebar &ndash;&gt;-->
<!--        <div class="col-md-2 sidebar">-->
<!--            <a href="/dashboard">üè† Dashboard</a>-->
<!--            <a href="/suspects">üë• Suspects</a>-->
<!--            <a href="/statistiques">üìä Statistiques</a>-->

<!--        </div>-->

<!--        &lt;!&ndash; D√©tails suspect &ndash;&gt;-->
<!--        <div class="col-md-10 p-4">-->
<!--            <h2 th:text="'D√©tails du suspect : ' + ${suspect.name} + ' ' + ${suspect.firstname}"></h2>-->

<!--            &lt;!&ndash; MESSAGES FLASH &ndash;&gt;-->
<!--            <div th:if="${successMessage}" class="alert alert-success mt-3" th:text="${successMessage}"></div>-->
<!--            <div th:if="${errorMessage}" class="alert alert-danger mt-3" th:text="${errorMessage}"></div>-->

<!--            <div class="suspect-details mt-4">-->
<!--                &lt;!&ndash; Image &ndash;&gt;-->
<!--                <img th:src="@{${suspect.imagePath}}" alt="Photo du suspect" class="suspect-img">-->

<!--                &lt;!&ndash; Infos &ndash;&gt;-->
<!--                <div class="info-block">-->
<!--                    <p><strong>Date de l'√©v√©nement :</strong> <span th:text="${suspect.evtDate}"></span></p>-->
<!--                    <p><strong>Document :</strong> <span th:text="${suspect.identityDocument}"></span></p>-->
<!--                    <p><strong>Identifiant :</strong> <span th:text="${suspect.identityString}"></span></p>-->
<!--                    <p><strong>Remarques :</strong> <span th:text="${suspect.remarqueText}"></span></p>-->
<!--                    <p><strong>Latitude / Longitude :</strong> <span th:text="${suspect.lat}"></span> / <span th:text="${suspect.lng}"></span></p>-->

<!--                    &lt;!&ndash; Statut &ndash;&gt;-->
<!--                    <div th:if="${suspect.statut == 1}" class="status-info mt-3">-->
<!--                        üîç <strong> Analyse effectu√©e !!! </strong>-->
<!--                    </div>-->

<!--                    <div th:if="${suspect.statut == 0}" class="mt-3">-->
<!--                        <form th:action="@{'/suspects/' + ${suspect.id} + '/analyser'}" method="post" onsubmit="showLoading()">-->
<!--                            <button type="submit">Analyser</button>-->
<!--                        </form>-->
<!--                        <div id="loadingSpinner">‚è≥ Analyse en cours...</div>-->
<!--                    </div>-->

<!--                    &lt;!&ndash; R√©sultat de pr√©diction &ndash;&gt;-->
<!--                    <div th:if="${suspect.prediction}" class="alert alert-info mt-3">-->
<!--                        <strong>R√©sultat de l'analyse :</strong> <span th:text="${suspect.prediction}"></span>-->
<!--                    </div>-->

<!--                    &lt;!&ndash; Formulaire d'enregistrement si inconnu &ndash;&gt;-->
<!--                    <div th:if="${suspect.prediction == 'inconnu'}">-->
<!--                        <form th:action="@{/suspects/{id}/enregistrer(id=${suspect.id})}" method="post">-->
<!--                            <label for="nomComplet">Merci de saisir le nom complet du suspect :</label>-->
<!--                            <input type="text" name="nomComplet" id="nomComplet" required>-->
<!--                            <button type="submit">Enregistrer ce visage</button>-->
<!--                        </form>-->
<!--                    </div>-->
<!--                    <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>-->
<!--                    &lt;!&ndash; Lien retour &ndash;&gt;-->
<!--                    <a th:href="@{/suspects}" class="back-link">‚Üê Retour √† la liste</a>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--<script>-->
<!--    function showLoading() {-->
<!--        document.getElementById('loadingSpinner').style.display = 'block';-->
<!--    }-->
<!--</script>-->

<!--<script>-->
<!--    function analyserImage(suspectId) {-->
<!--        document.getElementById('loadingSpinner').style.display = 'block';-->

<!--        fetch('/api/suspects/' + suspectId + '/image')  // Endpoint pour r√©cup√©rer l'image du suspect-->
<!--            .then(response => response.blob())-->
<!--            .then(blob => {-->
<!--                const formData = new FormData();-->
<!--                formData.append('file', blob, 'image.jpg');-->

<!--                return fetch('http://127.0.0.1:8000/detect_and_crop_faces/', {-->
<!--                    method: 'POST',-->
<!--                    body: formData-->
<!--                });-->
<!--            })-->
<!--            .then(response => response.json())-->
<!--            .then(data => {-->
<!--                document.getElementById('loadingSpinner').style.display = 'none';-->

<!--                if (data.faces && data.faces.length > 0) {-->
<!--                    const container = document.createElement('div');-->
<!--                    container.innerHTML = `<h4>Visages d√©tect√©s :</h4>`;-->

<!--                    data.faces.forEach(face => {-->
<!--                        const faceBlock = document.createElement('div');-->
<!--                        faceBlock.innerHTML = `-->
<!--                        <img src="${face.image_url}" style="width:120px; border-radius:6px;" />-->
<!--                        <form method="post" action="/suspects/${suspectId}/enregistrer">-->
<!--                            <input type="hidden" name="face_token" value="${face.face_token}" />-->
<!--                            <input type="text" name="nomComplet" placeholder="Nom complet" required />-->
<!--                            <button type="submit">Enregistrer</button>-->
<!--                        </form>-->
<!--                    `;-->
<!--                        container.appendChild(faceBlock);-->
<!--                    });-->

<!--                    document.querySelector(".info-block").appendChild(container);-->
<!--                } else {-->
<!--                    alert("Aucun visage d√©tect√©.");-->
<!--                }-->
<!--            })-->
<!--            .catch(error => {-->
<!--                document.getElementById('loadingSpinner').style.display = 'none';-->
<!--                console.error("Erreur d'analyse :", error);-->
<!--                alert("Erreur lors de l'analyse.");-->
<!--            });-->
<!--    }-->
<!--</script>-->

<!--</body>-->
<!--</html>-->


<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <title>D√©tails du suspect</title>-->
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--    <style>-->
<!--        body { background-color: #f8f9fa; }-->
<!--        .sidebar { height: 100vh; background-color: #343a40; color: white; padding-top: 20px; }-->
<!--        .sidebar a { color: #adb5bd; display: block; padding: 10px 20px; text-decoration: none; }-->
<!--        .sidebar a:hover { background-color: #495057; color: white; }-->
<!--        .profile-img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }-->
<!--        .suspect-details { display: flex; align-items: flex-start; gap: 20px; flex-wrap: wrap; }-->
<!--        .suspect-img { width: 300px; border-radius: 8px; box-shadow: 0 2px 6px rgba(23, 74, 211, 0.15); }-->
<!--        .info-block { flex: 1; }-->
<!--        .status-info { font-weight: bold; font-size: 1.1em; color: #6d884c; }-->
<!--        .back-link { display: inline-block; margin-top: 20px; color: #007bff; text-decoration: none; font-weight: 600; }-->
<!--        .back-link:hover { text-decoration: underline; }-->
<!--        button { background-color: #007bff; border: none; color: white; padding: 10px 16px; border-radius: 4px; cursor: pointer; font-size: 1em; margin-top: 15px; }-->
<!--        button:hover { background-color: #0056b3; }-->
<!--        #loadingSpinner { display: none; margin-top: 15px; color: #007bff; }-->
<!--        #map { height: 300px; width: 100%; margin-top: 20px; border: 1px solid #ccc; border-radius: 8px; }-->
<!--    </style>-->
<!--    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBKrKcA51GFGWFUsw96HZOrrCJRMIq1v_c"></script>-->
<!--    <script>-->
<!--        function initMap() {-->
<!--            const lat = parseFloat(document.getElementById('latitude').textContent);-->
<!--            const lng = parseFloat(document.getElementById('longitude').textContent);-->
<!--            const map = new google.maps.Map(document.getElementById("map"), {-->
<!--                zoom: 12,-->
<!--                center: { lat: lat, lng: lng }-->
<!--            });-->

<!--            const marker = new google.maps.Marker({-->
<!--                position: { lat: lat, lng: lng },-->
<!--                map: map,-->
<!--                title: "Position du suspect"-->
<!--            });-->
<!--        }-->

<!--        window.onload = initMap;-->
<!--    </script>-->
<!--</head>-->
<!--<body>-->
<!--<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">-->
<!--    <a class="navbar-brand" href="#">üöì Syst√®me De Reconnaissance Faciale</a>-->
<!--    <div class="ms-auto d-flex align-items-center gap-3">-->
<!--        <a href="/logout" class="btn btn-outline-light btn-sm">Compte</a>-->
<!--    </div>-->
<!--</nav>-->
<!--<div class="container-fluid">-->
<!--    <div class="row">-->
<!--        <div class="col-md-2 sidebar">-->
<!--            <a href="/dashboard">üè† Dashboard</a>-->
<!--            <a href="/suspects">üë• Suspects</a>-->
<!--            <a href="/statistiques">üìä Statistiques</a>-->
<!--        </div>-->
<!--        <div class="col-md-10 p-4">-->
<!--            <h2 th:text="'D√©tails du suspect : ' + ${suspect.name} + ' ' + ${suspect.firstname}"></h2>-->

<!--            <div th:if="${successMessage}" class="alert alert-success mt-3" th:text="${successMessage}"></div>-->
<!--            <div th:if="${errorMessage}" class="alert alert-danger mt-3" th:text="${errorMessage}"></div>-->

<!--            <div class="suspect-details mt-4">-->
<!--                <img th:src="@{${suspect.imagePath}}" alt="Photo du suspect" class="suspect-img">-->

<!--                <div class="info-block">-->
<!--                    <p><strong>Date de l'√©v√©nement :</strong> <span th:text="${suspect.evtDate}"></span></p>-->
<!--                    <p><strong>Document :</strong> <span th:text="${suspect.identityDocument}"></span></p>-->
<!--                    <p><strong>Identifiant :</strong> <span th:text="${suspect.identityString}"></span></p>-->
<!--                    <p><strong>Remarques :</strong> <span th:text="${suspect.remarqueText}"></span></p>-->
<!--                    <p><strong>Latitude / Longitude :</strong>-->
<!--                        <span id="latitude" th:text="${suspect.lat}"></span> / <span id="longitude" th:text="${suspect.lng}"></span>-->
<!--                    </p>-->

<!--                    <div id="map"></div>-->

<!--                    <div th:if="${suspect.statut == 1}" class="status-info mt-3">-->
<!--                        üîç <strong> Analyse effectu√©e !!! </strong>-->
<!--                    </div>-->

<!--                    <div th:if="${suspect.statut == 0}" class="mt-3">-->
<!--                        <form th:action="@{'/suspects/' + ${suspect.id} + '/analyser'}" method="post" onsubmit="showLoading()">-->
<!--                            <button type="submit">Analyser</button>-->
<!--                        </form>-->
<!--                        <div id="loadingSpinner">‚è≥ Analyse en cours...</div>-->
<!--                    </div>-->

<!--                    <div th:if="${suspect.prediction}" class="alert alert-info mt-3">-->
<!--                        <strong>R√©sultat de l'analyse :</strong> <span th:text="${suspect.prediction}"></span>-->
<!--                    </div>-->

<!--                    <div th:if="${suspect.prediction == 'inconnu'}">-->
<!--                        <form th:action="@{/suspects/{id}/enregistrer(id=${suspect.id})}" method="post">-->
<!--                            <label for="nomComplet">Merci de saisir le nom complet du suspect :</label>-->
<!--                            <input type="text" name="nomComplet" id="nomComplet" required>-->
<!--                            <button type="submit">Enregistrer ce visage</button>-->
<!--                        </form>-->
<!--                    </div>-->

<!--                    <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>-->
<!--                    <a th:href="@{/suspects}" class="back-link">‚Üê Retour √† la liste</a>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->
<!--<script>-->
<!--    function showLoading() {-->
<!--        document.getElementById('loadingSpinner').style.display = 'block';-->
<!--    }-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <title>D√©tails du suspect</title>-->
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--    <style>-->
<!--        body { background-color: #f8f9fa; }-->
<!--        .sidebar { height: 100vh; background-color: #343a40; color: white; padding-top: 20px; }-->
<!--        .sidebar a { color: #adb5bd; display: block; padding: 10px 20px; text-decoration: none; }-->
<!--        .sidebar a:hover { background-color: #495057; color: white; }-->
<!--        .profile-img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }-->
<!--        .suspect-details { display: flex; align-items: flex-start; gap: 20px; flex-wrap: wrap; }-->
<!--        .suspect-img { width: 300px; border-radius: 8px; box-shadow: 0 2px 6px rgba(23, 74, 211, 0.15); }-->
<!--        .info-block { flex: 1; }-->
<!--        .status-info { font-weight: bold; font-size: 1.1em; color: #6d884c; }-->
<!--        .back-link { display: inline-block; margin-top: 20px; color: #007bff; text-decoration: none; font-weight: 600; }-->
<!--        .back-link:hover { text-decoration: underline; }-->
<!--        button { background-color: #007bff; border: none; color: white; padding: 10px 16px; border-radius: 4px; cursor: pointer; font-size: 1em; margin-top: 15px; }-->
<!--        button:hover { background-color: #0056b3; }-->
<!--        #loadingSpinner { display: none; margin-top: 15px; color: #007bff; }-->
<!--        @media (max-width: 768px) {-->
<!--            .suspect-details { flex-direction: column; align-items: center; }-->
<!--            .suspect-img { width: 100%; max-width: 320px; }-->
<!--            .info-block { width: 100%; }-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">-->
<!--    <a class="navbar-brand" href="#">üöì Syst√®me De Reconnaissance Faciale</a>-->
<!--    <div class="ms-auto d-flex align-items-center gap-3">-->
<!--        <a href="/logout" class="btn btn-outline-light btn-sm">Compte</a>-->
<!--    </div>-->
<!--</nav>-->

<!--<div class="container-fluid">-->
<!--    <div class="row">-->
<!--        <div class="col-md-2 sidebar">-->
<!--            <a href="/dashboard">üè† Dashboard</a>-->
<!--            <a href="/suspects">üë• Suspects</a>-->
<!--            <a href="/statistiques">üìä Statistiques</a>-->
<!--        </div>-->

<!--        <div class="col-md-10 p-4">-->
<!--            <h2 th:text="'D√©tails du suspect : ' + ${suspect.name} + ' ' + ${suspect.firstname}"></h2>-->

<!--            <div th:if="${successMessage}" class="alert alert-success mt-3" th:text="${successMessage}"></div>-->
<!--            <div th:if="${errorMessage}" class="alert alert-danger mt-3" th:text="${errorMessage}"></div>-->

<!--            <div class="suspect-details mt-4">-->
<!--                <img th:src="@{${suspect.imagePath}}" alt="Photo du suspect" class="suspect-img">-->

<!--                <div class="info-block">-->
<!--                    <p><strong>Date de l'√©v√©nement :</strong> <span th:text="${suspect.evtDate}"></span></p>-->
<!--                    <p><strong>Document :</strong> <span th:text="${suspect.identityDocument}"></span></p>-->
<!--                    <p><strong>Identifiant :</strong> <span th:text="${suspect.identityString}"></span></p>-->
<!--                    <p><strong>Remarques :</strong> <span th:text="${suspect.remarqueText}"></span></p>-->
<!--                    <p><strong>Latitude / Longitude :</strong> <span th:text="${suspect.lat}"></span> / <span th:text="${suspect.lng}"></span></p>-->
<!--                    <p><strong> üìç Localit√© :</strong> <span id="locality">Chargement...</span></p>-->
<!--                    <p><a id="mapLink" target="_blank">Voir sur la carte</a></p>-->

<!--                    <div th:if="${suspect.statut == 1}" class="status-info mt-3">-->
<!--                        üîç <strong> Analyse effectu√©e ! </strong>-->
<!--                    </div>-->

<!--                    <div th:if="${suspect.statut == 0}" class="mt-3">-->
<!--                        <form th:action="@{'/suspects/' + ${suspect.id} + '/analyser'}" method="post" onsubmit="showLoading()">-->
<!--                            <button type="submit">Analyser</button>-->
<!--                        </form>-->
<!--                        <div id="loadingSpinner">‚è≥ Analyse en cours...</div>-->
<!--                    </div>-->

<!--                    <div th:if="${suspect.prediction}" class="alert alert-info mt-3">-->
<!--                        <strong>R√©sultat de l'analyse :</strong> <span th:text="${suspect.prediction}"></span>-->
<!--                    </div>-->

<!--                    <div th:if="${suspect.prediction == 'inconnu'}">-->
<!--                        <form th:action="@{/suspects/{id}/enregistrer(id=${suspect.id})}" method="post">-->
<!--                            <label for="nomComplet">Merci de saisir le nom complet du suspect :</label>-->
<!--                            <input type="text" name="nomComplet" id="nomComplet" required>-->
<!--                            <button type="submit">Enregistrer ce visage</button>-->
<!--                        </form>-->
<!--                    </div>-->
<!--                    <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>-->
<!--                    <a th:href="@{/suspects}" class="back-link">‚Üê Retour √† la liste</a>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--<script>-->
<!--    function showLoading() {-->
<!--        document.getElementById('loadingSpinner').style.display = 'block';-->
<!--    }-->
<!--</script>-->
<!--<script>-->
<!--    function reverseGeocode(lat, lng) {-->
<!--        const url = `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&format=json`;-->

<!--        fetch(url, {-->
<!--            headers: {-->
<!--                'User-Agent': 'facial-recognition-app/1.0'-->
<!--            }-->
<!--        })-->
<!--            .then(response => response.json())-->
<!--            .then(data => {-->
<!--                console.log("R√©ponse OSM:", data);-->
<!--                if (data && data.address) {-->
<!--                    const locality = data.address.city || data.address.town || data.address.village || data.address.hamlet || "Inconnu";-->
<!--                    document.getElementById("locality").innerText = locality;-->
<!--                    document.getElementById("mapLink").href = `https://www.openstreetmap.org/?mlat=${lat}&mlon=${lng}#map=12/${lat}/${lng}`;-->
<!--                } else {-->
<!--                    document.getElementById("locality").innerText = "Localit√© introuvable";-->
<!--                }-->
<!--            })-->
<!--            .catch(err => {-->
<!--                console.error("Erreur OSM:", err);-->
<!--                document.getElementById("locality").innerText = "Erreur de localisation";-->
<!--            });-->
<!--    }-->

<!--    window.onload = function () {-->
<!--        let lat = /*[[${suspect.lat}]]*/ 0;-->
<!--        let lng = /*[[${suspect.lng}]]*/ 0;-->
<!--        reverseGeocode(lat, lng);-->
<!--    }-->
<!--</script>-->

<!--</body>-->
<!--</html>-->





<!--SANS STYLE-->

<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <title>D√©tails du suspect</title>-->
<!--    <meta charset="UTF-8">-->
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">-->
<!--    <style>-->
<!--        body {-->
<!--            margin: 0;-->
<!--            padding: 0;-->
<!--            background-color: #f8f9fa;-->
<!--            font-family: Arial, sans-serif;-->
<!--            display: flex;-->
<!--        }-->

<!--        .sidebar {-->
<!--            width: 220px;-->
<!--            background-color: #1e1e2f;-->
<!--            color: white;-->
<!--            padding: 20px;-->
<!--            height: 100vh;-->
<!--            position: fixed;-->
<!--        }-->

<!--        .sidebar h3 {-->
<!--            text-align: center;-->
<!--            margin-bottom: 30px;-->
<!--            font-size: 24px;-->
<!--        }-->

<!--        .sidebar a {-->
<!--            text-decoration: none;-->
<!--            color: #ccc;-->
<!--            padding: 12px;-->
<!--            margin: 5px 0;-->
<!--            border-radius: 8px;-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            transition: background 0.3s;-->
<!--        }-->

<!--        .sidebar a:hover {-->
<!--            background-color: #333;-->
<!--            color: #fff;-->
<!--        }-->

<!--        .sidebar i {-->
<!--            margin-right: 10px;-->
<!--        }-->

<!--        .main-content {-->
<!--            margin-left: 220px;-->
<!--            padding: 40px;-->
<!--            flex-grow: 1;-->
<!--        }-->

<!--        .suspect-details {-->
<!--            display: flex;-->
<!--            flex-wrap: wrap;-->
<!--            gap: 30px;-->
<!--        }-->

<!--        .suspect-img {-->
<!--            width: 300px;-->
<!--            border-radius: 8px;-->
<!--            box-shadow: 0 2px 6px rgba(0,0,0,0.1);-->
<!--        }-->

<!--        .info-block {-->
<!--            flex: 1;-->
<!--            min-width: 300px;-->
<!--        }-->

<!--        button {-->
<!--            background-color: #007bff;-->
<!--            border: none;-->
<!--            color: white;-->
<!--            padding: 10px 16px;-->
<!--            border-radius: 4px;-->
<!--            cursor: pointer;-->
<!--            font-size: 1em;-->
<!--        }-->

<!--        button:hover {-->
<!--            background-color: #0056b3;-->
<!--        }-->

<!--        .back-link {-->
<!--            margin-top: 20px;-->
<!--            display: inline-block;-->
<!--            color: #007bff;-->
<!--            text-decoration: none;-->
<!--            font-weight: 600;-->
<!--        }-->

<!--        .back-link:hover {-->
<!--            text-decoration: underline;-->
<!--        }-->

<!--        #loadingSpinner {-->
<!--            display: none;-->
<!--            margin-top: 15px;-->
<!--            color: #007bff;-->
<!--        }-->

<!--        .status-info {-->
<!--            font-weight: bold;-->
<!--            font-size: 1.1em;-->
<!--            color: #6d884c;-->
<!--        }-->

<!--        @media (max-width: 768px) {-->
<!--            .sidebar {-->
<!--                display: none;-->
<!--            }-->

<!--            .main-content {-->
<!--                padding: 20px;-->
<!--            }-->

<!--            .suspect-details {-->
<!--                flex-direction: column;-->
<!--                align-items: center;-->
<!--            }-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--&lt;!&ndash; Sidebar &ndash;&gt;-->
<!--<div class="sidebar">-->
<!--    <h3>Face AI</h3>-->
<!--    <a href="/add"><i class="fas fa-user-plus"></i> Ajouter un suspect</a>-->
<!--    <a href="/suspects"><i class="fas fa-users"></i> Liste des suspects</a>-->
<!--    <a href="/predictions/predictions"><i class="fas fa-eye"></i> Pr√©dictions</a>-->
<!--    <a href="/logout"><i class="fas fa-sign-out-alt"></i> D√©connexion</a>-->
<!--</div>-->

<!--&lt;!&ndash; Main content &ndash;&gt;-->
<!--<div class="main-content">-->
<!--    <h2 th:text="'D√©tails du suspect : ' + ${suspect.name} + ' ' + ${suspect.firstname}"></h2>-->

<!--    <div th:if="${successMessage}" class="alert alert-success mt-3" th:text="${successMessage}"></div>-->
<!--    <div th:if="${errorMessage}" class="alert alert-danger mt-3" th:text="${errorMessage}"></div>-->

<!--    <div class="suspect-details mt-4">-->
<!--        <img th:src="@{${suspect.imagePath}}" alt="Photo du suspect" class="suspect-img">-->

<!--        <div class="info-block">-->
<!--            <p><strong>Date de l'√©v√©nement :</strong> <span th:text="${suspect.evtDate}"></span></p>-->
<!--            <p><strong>Document :</strong> <span th:text="${suspect.identityDocument}"></span></p>-->
<!--            <p><strong>Identifiant :</strong> <span th:text="${suspect.identityString}"></span></p>-->
<!--            <p><strong>Remarques :</strong> <span th:text="${suspect.remarqueText}"></span></p>-->
<!--            <p><strong>Latitude / Longitude :</strong> <span th:text="${suspect.lat}"></span> / <span th:text="${suspect.lng}"></span></p>-->
<!--            <p><strong>üìç Localit√© :</strong> <span id="locality">Chargement...</span></p>-->
<!--            <p><a id="mapLink" target="_blank">Voir sur la carte</a></p>-->

<!--            <div th:if="${suspect.statut == 1}" class="status-info mt-3">-->
<!--                üîç <strong>Analyse effectu√©e !</strong>-->
<!--            </div>-->

<!--            <div th:if="${suspect.statut == 0}" class="mt-3">-->
<!--                <form th:action="@{'/suspects/' + ${suspect.id} + '/analyser'}" method="post" onsubmit="showLoading()">-->
<!--                    <button type="submit">Analyser</button>-->
<!--                </form>-->
<!--                <div id="loadingSpinner">‚è≥ Analyse en cours...</div>-->
<!--            </div>-->

<!--            <div th:if="${suspect.prediction}" class="alert alert-info mt-3">-->
<!--                <strong>R√©sultat de l'analyse :</strong> <span th:text="${suspect.prediction}"></span>-->
<!--            </div>-->

<!--            <div th:if="${suspect.prediction == 'inconnu'}">-->
<!--                <form th:action="@{/suspects/{id}/enregistrer(id=${suspect.id})}" method="post">-->
<!--                    <label for="nomComplet">Merci de saisir le nom complet du suspect :</label>-->
<!--                    <input type="text" name="nomComplet" id="nomComplet" required class="form-control mb-2">-->
<!--                    <button type="submit">Enregistrer ce visage</button>-->
<!--                </form>-->
<!--            </div>-->

<!--            <a th:href="@{/suspects}" class="back-link">‚Üê Retour √† la liste</a>-->

<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash;<script th:inline="javascript">&ndash;&gt;-->

<!--&lt;!&ndash;    let lat = [[${suspect.lat}]];&ndash;&gt;-->
<!--&lt;!&ndash;    let lng = [[${suspect.lng}]];&ndash;&gt;-->

<!--&lt;!&ndash;    console.log("Coordonn√©es inject√©es :", lat, lng);&ndash;&gt;-->

<!--&lt;!&ndash;    function reverseGeocode(lat, lng) {&ndash;&gt;-->
<!--&lt;!&ndash;        const url = `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&format=json`;&ndash;&gt;-->

<!--&lt;!&ndash;        fetch(url, {&ndash;&gt;-->
<!--&lt;!&ndash;            headers: {&ndash;&gt;-->
<!--&lt;!&ndash;                'User-Agent': 'facial-recognition-app/1.0'&ndash;&gt;-->
<!--&lt;!&ndash;            }&ndash;&gt;-->
<!--&lt;!&ndash;        })&ndash;&gt;-->
<!--&lt;!&ndash;            .then(response => response.json())&ndash;&gt;-->
<!--&lt;!&ndash;            .then(data => {&ndash;&gt;-->
<!--&lt;!&ndash;                if (data && data.address) {&ndash;&gt;-->
<!--&lt;!&ndash;                    const locality = data.address.city || data.address.town || data.address.village || data.address.hamlet || "Inconnue";&ndash;&gt;-->
<!--&lt;!&ndash;                    document.getElementById("locality").innerText = locality;&ndash;&gt;-->
<!--&lt;!&ndash;                    document.getElementById("mapLink").href = `https://www.openstreetmap.org/?mlat=${lat}&mlon=${lng}#map=12/${lat}/${lng}`;&ndash;&gt;-->
<!--&lt;!&ndash;                } else {&ndash;&gt;-->
<!--&lt;!&ndash;                    document.getElementById("locality").innerText = "Localit√© introuvable";&ndash;&gt;-->
<!--&lt;!&ndash;                }&ndash;&gt;-->
<!--&lt;!&ndash;            })&ndash;&gt;-->
<!--&lt;!&ndash;            .catch(err => {&ndash;&gt;-->
<!--&lt;!&ndash;                console.error("Erreur OSM:", err);&ndash;&gt;-->
<!--&lt;!&ndash;                document.getElementById("locality").innerText = "Erreur de localisation";&ndash;&gt;-->
<!--&lt;!&ndash;            });&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    window.onload = function () {&ndash;&gt;-->
<!--&lt;!&ndash;        reverseGeocode(lat, lng);&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->
<!--&lt;!&ndash;</script>&ndash;&gt;-->

<!--<script th:inline="javascript">-->
<!--    let lat = /*[[${suspect.lat}]]*/ null;-->
<!--    let lng = /*[[${suspect.lng}]]*/ null;-->

<!--    console.log("Coordonn√©es inject√©es :", lat, lng);-->

<!--    function reverseGeocode(lat, lng) {-->
<!--        const url = `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&format=json`;-->

<!--        fetch(url, {-->
<!--            headers: {-->
<!--                'User-Agent': 'facial-recognition-app/1.0' // Indispensable pour Nominatim-->
<!--            }-->
<!--        })-->
<!--            .then(response => response.json())-->
<!--            .then(data => {-->
<!--                if (data && data.display_name) {-->
<!--                    // Utilise display_name qui est l'adresse compl√®te format√©e-->
<!--                    const fullAddress = data.display_name;-->
<!--                    document.getElementById("locality").innerText = fullAddress;-->
<!--                    document.getElementById("mapLink").href = `https://www.openstreetmap.org/?mlat=${lat}&mlon=${lng}#map=12/${lat}/${lng}`;-->
<!--                } else if (data && data.address) {-->
<!--                    // Option de secours si display_name n'est pas id√©al, construire l'adresse-->
<!--                    const addressComponents = [];-->
<!--                    if (data.address.house_number) addressComponents.push(data.address.house_number);-->
<!--                    if (data.address.road) addressComponents.push(data.address.road);-->
<!--                    if (data.address.postcode) addressComponents.push(data.address.postcode);-->
<!--                    if (data.address.city || data.address.town || data.address.village) {-->
<!--                        addressComponents.push(data.address.city || data.address.town || data.address.village);-->
<!--                    }-->
<!--                    if (data.address.country) addressComponents.push(data.address.country);-->

<!--                    const constructedAddress = addressComponents.join(', ');-->
<!--                    document.getElementById("locality").innerText = constructedAddress || "Adresse introuvable";-->
<!--                    document.getElementById("mapLink").href = `https://www.openstreetmap.org/?mlat=${lat}&mlon=${lng}#map=12/${lat}/${lng}`;-->
<!--                } else {-->
<!--                    document.getElementById("locality").innerText = "Adresse introuvable";-->
<!--                }-->
<!--            })-->
<!--            .catch(err => {-->
<!--                console.error("Erreur lors de la g√©olocalisation inverse:", err);-->
<!--                document.getElementById("locality").innerText = "Erreur de localisation";-->
<!--            });-->
<!--    }-->

<!--    window.onload = function () {-->
<!--        if (typeof lat === 'number' && typeof lng === 'number' && !isNaN(lat) && !isNaN(lng)) {-->
<!--            reverseGeocode(lat, lng);-->
<!--        } else {-->
<!--            document.getElementById("locality").innerText = "Coordonn√©es indisponibles";-->
<!--            document.getElementById("mapLink").style.display = "none";-->
<!--        }-->
<!--    }-->

<!--    function showLoading() {-->
<!--        document.getElementById("loadingSpinner").style.display = "block";-->
<!--    }-->
<!--</script>-->
<!--</body>-->
<!--</html>-->


<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>D√©tails du suspect</title>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4A90E2; /* Bleu plus doux */
            --secondary-color: #6C757D; /* Gris */
            --light-bg: #ECF0F1; /* Gris clair pour l'arri√®re-plan */
            --card-bg: #FFFFFF; /* Blanc pour les cartes */
            --text-color: #34495E; /* Gris fonc√© pour le texte */
            --border-color: #DDE6ED;
            --dark-heading-color: #2C3E50; /* Couleur des titres */
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--light-bg);
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            display: flex;
            color: var(--text-color);
        }

        /* Styles de la sidebar (non modifi√©s, repris de votre code original) */
        .sidebar {
            width: 220px;
            background-color: #1e1e2f;
            color: white;
            padding: 20px;
            height: 100vh;
            position: fixed;
        }

        .sidebar h3 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
        }

        .sidebar a {
            text-decoration: none;
            color: #ccc;
            padding: 12px;
            margin: 5px 0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            transition: background 0.3s;
        }

        .sidebar a:hover {
            background-color: #333;
            color: #fff;
        }

        .sidebar i {
            margin-right: 10px;
        }

        /* Fin des styles de la sidebar */

        .main-content {
            margin-left: 220px;
            padding: 40px;
            flex-grow: 1;
            width: calc(100% - 220px);
        }

        h2 {
            color: var(--dark-heading-color);
            margin-bottom: 30px;
            font-weight: 600;
        }

        .suspect-details-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            padding: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            align-items: flex-start;
        }

        .suspect-img {
            width: 300px;
            height: 300px;
            object-fit: cover;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border: 2px solid var(--primary-color);
        }

        .info-block {
            flex: 1;
            min-width: 350px;
            line-height: 1.8;
        }

        .info-block p {
            margin-bottom: 10px;
            font-size: 1.05em;
        }

        .info-block strong {
            color: var(--dark-heading-color);
            min-width: 150px;
            display: inline-block;
        }

        button, .btn-primary {
            background-color: var(--primary-color);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.05em;
            font-weight: 500;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        button:hover, .btn-primary:hover {
            background-color: #3A7ABD;
            transform: translateY(-2px);
        }

        .back-link {
            margin-top: 30px;
            display: inline-block;
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1em;
            transition: color 0.3s ease;
        }

        .back-link:hover {
            color: #3A7ABD;
            text-decoration: underline;
        }

        #loadingSpinner {
            display: none;
            margin-top: 20px;
            color: var(--primary-color);
            font-size: 1.1em;
            font-weight: 500;
        }

        .status-info {
            font-weight: bold;
            font-size: 1.1em;
            color: #28A745;
            margin-top: 20px;
        }

        .alert {
            border-radius: 8px;
            font-size: 1.05em;
        }
        .alert-success {
            background-color: #D4EDDA;
            color: #155724;
            border-color: #C3E6CB;
        }
        .alert-danger {
            background-color: #F8D7DA;
            color: #721C24;
            border-color: #F5C6CB;
        }
        .alert-info {
            background-color: #D1ECF1;
            color: #0C5460;
            border-color: #BEE5EB;
        }

        form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
        }
        form .form-control {
            border-radius: 6px;
            border: 1px solid var(--border-color);
            padding: 10px;
            font-size: 1em;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
        form .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(74, 144, 226, 0.25);
        }

        @media (max-width: 992px) {
            .suspect-details-card {
                flex-direction: column;
                align-items: center;
                gap: 25px;
            }
            .suspect-img {
                width: 250px;
                height: 250px;
            }
            .info-block {
                min-width: unset;
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
                width: 100%;
            }

            h2 {
                font-size: 24px;
                text-align: center;
            }

            .suspect-details-card {
                padding: 20px;
            }

            .suspect-img {
                width: 200px;
                height: 200px;
            }

            button, .btn-primary {
                width: 100%;
                text-align: center;
            }
        }
        .sidebar-button {
            background: none;
            border: none;
            color: #ccc; /* Couleur du texte des liens */
            padding: 12px;
            margin: 5px 0;
            border-radius: 8px;
            display: flex; /* Pour aligner l'ic√¥ne et le texte */
            align-items: center;
            width: 100%; /* Pour qu'il prenne toute la largeur disponible comme les liens */
            text-align: left; /* Pour aligner le texte √† gauche */
            cursor: pointer; /* Indique qu'il est cliquable */
            transition: background 0.3s, color 0.3s;
        }

        .sidebar-button:hover {
            background-color: #333;
            color: #fff;
        }

        /* Assurez-vous que l'ic√¥ne √† l'int√©rieur du bouton est √©galement stylis√©e */
        .sidebar-button i {
            margin-right: 10px;
        }
    </style>
</head>
<body>

<div class="sidebar">
    <h3>Face AI</h3>
    <a href="/add"><i class="fas fa-user-plus"></i> Ajouter un suspect</a>
    <a href="/suspects"><i class="fas fa-users"></i> Liste des suspects</a>
    <a href="/predictions/predictions"><i class="fas fa-eye"></i> Pr√©dictions</a>
    <a th:if="${#authorization.expression('hasRole(''ADMIN'')')}" href="/admin/users"><i class="fas fa-users-cog"></i> Gestion Utilisateurs</a>
<!--    <a href="/logout"><i class="fas fa-sign-out-alt"></i> D√©connexion</a>-->
    <form th:action="@{/logout}" method="post" style="display: inline;">
        <button type="submit" class="sidebar-button">
            <i class="fas fa-sign-out-alt"></i> D√©connexion
        </button>
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    </form>
</div>

<div class="main-content">
    <h2 th:text="'D√©tails du suspect : ' + ${suspect.name} + ' ' + ${suspect.firstname}"></h2>

    <div th:if="${successMessage}" class="alert alert-success mt-3" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="alert alert-danger mt-3" th:text="${errorMessage}"></div>

    <div class="suspect-details-card mt-4">
        <img th:src="@{${suspect.imagePath}}" alt="Photo du suspect" class="suspect-img">

        <div class="info-block">
            <p><strong>Date de l'√©v√©nement :</strong> <span th:text="${suspect.evtDate}"></span></p>
            <p><strong>Document :</strong> <span th:text="${suspect.identityDocument}"></span></p>
            <p><strong>Identifiant :</strong> <span th:text="${suspect.identityString}"></span></p>
            <p><strong>Remarques :</strong> <span th:text="${suspect.remarqueText}"></span></p>
            <p><strong>üìç Localit√© :
                <span th:if="${suspect.lat != null and suspect.lng != null}">
                    <span id="locality" th:data-lat="${suspect.lat}" th:data-lng="${suspect.lng}">Chargement...</span>
                    <a id="mapLink" target="_blank" style="margin-left: 10px; display: none; color: var(--primary-color);">Voir sur la carte</a>
                </span>
<!--                <span th:else>-->
<!--                    Coordonn√©es indisponibles-->
<!--                </span>-->
            </strong>
            </p>

            <div th:if="${suspect.statut == 1}" class="status-info mt-3">
                <i class="fas fa-check-circle"></i> <strong>Analyse effectu√©e !</strong>
            </div>

            <div th:if="${suspect.statut == 0}" class="mt-3">
                <form th:action="@{'/suspects/' + ${suspect.id} + '/analyser'}" method="post" onsubmit="showLoading()">
                    <button type="submit">Analyser</button>
                </form>
                <div id="loadingSpinner"><i class="fas fa-hourglass-half"></i> Analyse en cours...</div>
            </div>

            <div th:if="${suspect.prediction}" class="alert alert-info mt-3">
                <strong>R√©sultat de l'analyse :</strong> <span th:text="${suspect.prediction}"></span>
            </div>

            <div th:if="${suspect.prediction == 'inconnu'}">
                <form th:action="@{/suspects/{id}/enregistrer(id=${suspect.id})}" method="post" class="mt-4">
                    <label for="nomComplet">Merci de saisir le nom complet du suspect :</label>
                    <input type="text" name="nomComplet" id="nomComplet" required class="form-control mb-3">
                    <button type="submit">Enregistrer ce visage</button>
                </form>
            </div>

            <a th:href="@{/suspects}" class="back-link">‚Üê Retour √† la liste</a>

        </div>
    </div>
</div>

<script th:inline="javascript">
    function reverseGeocode(lat, lng, spanElement, mapLinkElement) {
        const url = `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&format=json`;

        fetch(url, {
            headers: {
                'User-Agent': 'facial-recognition-app/1.0 (mandasoumare1983@gmail.com)'
            }
        })
            .then(response => {
                if (!response.ok) {
                    if (response.status === 429) {
                        throw new Error("Trop de requ√™tes. Veuillez r√©essayer plus tard.");
                    }
                    throw new Error(`Erreur HTTP: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                if (data && data.display_name) {
                    spanElement.innerText = data.display_name;
                    mapLinkElement.href = `https://www.openstreetmap.org/?mlat=${lat}&mlon=${lng}#map=12/${lat}/${lng}`;
                    mapLinkElement.style.display = "inline";
                } else if (data && data.address) {
                    const addressComponents = [];
                    if (data.address.house_number) addressComponents.push(data.address.house_number);
                    if (data.address.road) addressComponents.push(data.address.road);
                    if (data.address.postcode) addressComponents.push(data.address.postcode);
                    if (data.address.city || data.address.town || data.address.village) {
                        addressComponents.push(data.address.city || data.address.town || data.address.village);
                    }
                    if (data.address.country) addressComponents.push(data.address.country);

                    const constructedAddress = addressComponents.filter(Boolean).join(', ');
                    spanElement.innerText = constructedAddress || "Adresse introuvable";
                    mapLinkElement.href = `https://www.openstreetmap.org/?mlat=${lat}&mlon=${lng}#map=12/${lat}/${lng}`;
                    mapLinkElement.style.display = "inline";
                } else {
                    spanElement.innerText = "Adresse introuvable";
                }
            })
            .catch(err => {
                console.error("Erreur de g√©olocalisation inverse:", err);
                spanElement.innerText = `Erreur: ${err.message || 'Impossible de charger l\'adresse'}`;
            });
    }

    function showLoading() {
        document.getElementById("loadingSpinner").style.display = "block";
    }

    window.onload = function() {
        const localitySpan = document.getElementById("locality");
        const mapLink = document.getElementById("mapLink");

        if (localitySpan && mapLink) {
            const lat = localitySpan.dataset.lat;
            const lng = localitySpan.dataset.lng;

            if (lat && lng && !isNaN(parseFloat(lat)) && !isNaN(parseFloat(lng))) {
                reverseGeocode(parseFloat(lat), parseFloat(lng), localitySpan, mapLink);
            } else {
                localitySpan.innerText = "Coordonn√©es indisponibles";
                mapLink.style.display = "none";
            }
        }
    };
</script>

</body>
</html>